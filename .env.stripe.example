# ===============================
# STRIPE CONFIGURATION
# Complete guide for setting up Stripe in the marketplace
# ===============================

# ==== CORE STRIPE KEYS (REQUIRED) ====
# Get these from https://dashboard.stripe.com/test/apikeys

# Secret key for server-side operations
STRIPE_SECRET_KEY=sk_test_YOUR_SECRET_KEY_HERE

# Publishable key for client-side operations  
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_YOUR_PUBLISHABLE_KEY_HERE

# ==== WEBHOOK SECRETS (REQUIRED) ====
# Get these from https://dashboard.stripe.com/test/webhooks
# You need to create THREE webhook endpoints:

# 1. Main webhook endpoint: https://your-domain.com/api/stripe/webhooks
STRIPE_WEBHOOK_SECRET=whsec_YOUR_MAIN_WEBHOOK_SECRET

# 2. Connect webhook endpoint: https://your-domain.com/api/stripe/webhooks/connect
STRIPE_CONNECT_WEBHOOK_SECRET=whsec_YOUR_CONNECT_WEBHOOK_SECRET

# 3. Marketplace webhook endpoint: https://your-domain.com/api/stripe/webhooks/marketplace
STRIPE_MARKETPLACE_WEBHOOK_SECRET=whsec_YOUR_MARKETPLACE_WEBHOOK_SECRET

# ==== STRIPE CONNECT (REQUIRED FOR MARKETPLACE) ====
# Get from https://dashboard.stripe.com/test/settings/connect
STRIPE_CONNECT_CLIENT_ID=ca_YOUR_CONNECT_CLIENT_ID

# ==== PLATFORM CONFIGURATION (REQUIRED - DO NOT CHANGE) ====
# These values are part of the business model and should not be modified
NEXT_PUBLIC_PLATFORM_FEE_PERCENT=10      # Platform takes 10% commission
NEXT_PUBLIC_GUEST_FEE_PERCENT=10         # Guests pay additional 10% surcharge
ACTIVE_PAYMENT_PROVIDER=stripe           # Payment provider selection

# ==== CRON JOB SECURITY (REQUIRED FOR PRODUCTION) ====
# Generate with: openssl rand -base64 32
CRON_SECRET=YOUR_SECURE_CRON_SECRET_HERE

# ==== MONITORING & ALERTS (OPTIONAL BUT RECOMMENDED) ====
# Slack webhook for payment alerts
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Sentry for error tracking (optional)
SENTRY_DSN=https://YOUR_KEY@o123456.ingest.sentry.io/PROJECT_ID

# ==== WEBHOOK EVENTS TO CONFIGURE ====
# When setting up webhooks in Stripe Dashboard, enable these events:

# For main webhook (/api/stripe/webhooks):
# - checkout.session.completed
# - customer.subscription.updated
# - customer.subscription.deleted
# - invoice.payment_succeeded
# - invoice.payment_failed
# - payment_intent.succeeded
# - payment_intent.payment_failed
# - payment_intent.canceled
# - charge.dispute.created
# - transfer.created
# - transfer.paid
# - transfer.failed

# For Connect webhook (/api/stripe/webhooks/connect):
# - account.updated
# - account.application.deauthorized
# - capability.updated
# - person.created
# - person.updated
# - person.deleted

# For Marketplace webhook (/api/stripe/webhooks/marketplace):
# - application_fee.created
# - application_fee.refunded
# - payment_intent.succeeded (for marketplace payments)
# - transfer.created
# - transfer.reversed
# - payout.created
# - payout.paid
# - payout.failed

# ==== TESTING CONFIGURATION ====
# For local development with Stripe CLI
# Run: stripe listen --forward-to localhost:3001/api/stripe/webhooks
# This will give you a temporary webhook secret for testing

# ==== PRODUCTION CHECKLIST ====
# Before going live, ensure:
# 1. ✅ All webhook endpoints are configured in Stripe Dashboard
# 2. ✅ All webhook secrets are set correctly
# 3. ✅ CRON_SECRET is set with a secure random value
# 4. ✅ Platform fees are correctly configured (10% platform, 10% guest)
# 5. ✅ Stripe Connect is enabled and configured
# 6. ✅ All webhook events listed above are enabled
# 7. ✅ Monitoring/alerting is configured (Slack/Sentry)
# 8. ✅ Test mode is disabled in production
# 9. ✅ Live keys are used instead of test keys
# 10. ✅ Reconciliation cron jobs are scheduled

# ==== CRON JOB CONFIGURATION (FOR VERCEL) ====
# Add these to your vercel.json:
# {
#   "crons": [
#     {
#       "path": "/api/cron/process-payouts",
#       "schedule": "0 * * * *"
#     },
#     {
#       "path": "/api/cron/reconcile-payments",
#       "schedule": "0 2 * * *"
#     }
#   ]
# }

# ===============================
# AGENT SYSTEM CONFIGURATION  
# Configuration for the AI agent orchestration system
# ===============================

# ==== CORE AGENT SETTINGS (REQUIRED) ====
AGENTS_ENABLED=true
AGENT_AUTO_INITIALIZE=true
AGENT_HEALTH_CHECK_INTERVAL=30000
AGENT_TASK_TIMEOUT=300000
AGENT_MAX_CONCURRENT_TASKS=10
AGENT_RETRY_MAX_ATTEMPTS=3
AGENT_MONITORING_ENABLED=true

# ==== MCP SERVER CONFIGURATION (REQUIRED) ====
# Enable/disable specific MCP servers used by agents
MCP_SEQUENTIAL_THINKING_ENABLED=true
MCP_FILESYSTEM_ENABLED=true
MCP_MEMORY_ENABLED=true
MCP_GITHUB_ENABLED=true
MCP_NOTION_ENABLED=true
MCP_IDE_ENABLED=true
MCP_VERCEL_ENABLED=true
MCP_POSTGRES_ENABLED=true

# ==== AGENT RESOURCE LIMITS (PRODUCTION TUNING) ====
AGENT_MEMORY_LIMIT_MB=512
AGENT_CPU_LIMIT_PERCENT=50
AGENT_DISK_QUOTA_MB=1024

# ==== AGENT SECURITY (REQUIRED FOR PRODUCTION) ====
AGENT_SANDBOX_MODE=true
AGENT_NETWORK_ISOLATION=false
AGENT_FILE_ACCESS_RESTRICTED=true
AGENT_ALLOWED_DOMAINS=localhost,127.0.0.1,*.vercel.app,*.stripe.com,*.clerk.dev,*.supabase.co

# ==== PERFORMANCE & MONITORING (OPTIONAL BUT RECOMMENDED) ====
AGENT_METRICS_COLLECTION=true
AGENT_PERFORMANCE_LOGGING=true
AGENT_ERROR_TRACKING=true
PROMETHEUS_METRICS_ENDPOINT=/api/agents/metrics

# ==== AGENT WORKFLOW CONFIGURATION ====
# Maximum number of workflow executions that can run concurrently
AGENT_MAX_CONCURRENT_WORKFLOWS=5
# Default timeout for workflow execution (in milliseconds)
AGENT_WORKFLOW_TIMEOUT=600000
# Enable human-in-the-loop approval for sensitive operations
AGENT_REQUIRE_HUMAN_APPROVAL=true

# ==== MARKETPLACE AGENT CONFIGURATION ====
# Enable agent-powered search and recommendations
AGENT_SEARCH_ENABLED=true
AGENT_RECOMMENDATIONS_ENABLED=true
# Maximum number of search results to process
AGENT_SEARCH_MAX_RESULTS=50
# Enable automated provider matching
AGENT_AUTO_MATCHING_ENABLED=false